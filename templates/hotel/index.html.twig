{% extends 'base.html.twig' %}
{% block stylesheets %}
{{parent()}}

{% endblock %}



{% block body %}
<main>

<!-- Button trigger modal -->



 <div class="container-fluid">
    <div class="row">
        <div class="col-lg-6 py-4 p-xl-5">
          <h2 class="mb-4">Stay on Manhattan, NY</h2>
          <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Distinctio asperiores, consequatur odio recusandae dignissimos hic ad minima! Praesentium nobis dolorem blanditiis molestiae facilis neque accusantium voluptas. Esse ea ipsum iusto.</p>
          <hr class="my-4">
          <div class="d-flex justify-content-between align-items-center flex-column flex-md-row mb-4">
            <div class="me-3">
              <p class="mb-3 mb-md-0"><strong>12</strong> results found</p>
            </div>
          </div>
          <div class="row p-2">
          <div class="col-sm-6">
            <div class="packege__item">
                <div class="packege__inner">

                    <div class="packege__thumb">
                        <a href="tour-single.html"><img
                                src="https://template.labartisan.net/demos/explore/assets/images/packege/03.jpg"
                                alt="Travel Thumb"></a>
                        <div class="cart-right">
                            <button tabindex="0" class="addcart-box" title="Quick shop"><i
                                    class="ti-shopping-cart"></i></button>

                        </div>
                    </div>

                    <div class="packege__content">
                        <a href="tour-single.html">
                            <h5 style="color:#222">Enjoy the Beauty place in Bhutan City</h5>
                        </a>
                        <div class="packege__rivew">
                            <div class="left">
                                <span class="rating">Si crees que estÃ¡s en peligro, tienes acceso
                                    prioritario a un equipo especializado que te atenderÃ¡ sea la hora que
                                    sea</span>
                            </div>
                            <div class="right">
                                <span class="packege__price">746 â‚¬ por noche</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
           
          </div>

          
        </div>
   
<div class="col-lg-6 map-side-lg pe-lg-0 " style="z-index: -3;">
      <div class="sticky-top" style="top: 80px">
          <div class="map "  id="map" ></div>
        </div>
        </div>
      
        
      </div>
    </div>


<ul class="chec-radio">
	<li class="pz">
		<label class="radio-inline">
			<input type="radio"  id="Hotel" name="property_type" class="pro-chx" value="constructed">
			<div class="clab">Hotel</div>
		</label>
	</li>
	<li class="pz">
		<label class="radio-inline">
			<input type="radio" id="Hostal" name="property_type" class="pro-chx" value="unconstructed" >
		 <div class="clab">Hostal</div>
		</label>
	</li>
	<li class="pz">
		<label class="radio-inline">
			<input type="radio" id="albergue" name="property_type" class="pro-chx" value="open_land">
			<div class="clab">Albergue</div>
		</label>
	</li>
  <li class="pz">
		<label class="radio-inline">
			<input type="radio" id="casaRural" name="property_type" class="pro-chx" value="open_land">
			<div class="clab">Casa Rural</div>
		</label>
	</li>
  <li class="pz">
		<label class="radio-inline">
			<input type="radio" id="propietario" name="property_type" class="pro-chx" value="open_land">
			<div class="clab">Propietario</div>
		</label>
	</li>
</ul>



<div class="modal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Modal title</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p>Modal body text goes here.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>



<div id="ids" class="d-flex flex-row bg-light" style="position: relative;">
    <div class="divHoteles" id="divH">
    
       <button type="button" class="btn btn-light" id="boton" style="width: 3rem; float-right">X</button>
    <div class=" p-4" id="mensajes">
      <h4 class="fw-bold text-secondary">Mas de un numero indefinido de Hoteles</h4>
      <hr style="width: 100%;">
      <div id="alojamientos">
           <div id="alo-b">
           {% for hotel in hoteles %}

                <div class="" style="width: 100%; ">
      
      
                       <a class="d-flex flex-column flex-md-row col-12 justify-content-center align-items-center gap-4" href="{{ path('alojamiento', {'nombre':hotel.getNombre()})}}" style="text-decoration:none">
        
                       <div>
                        <img class="img-fluid " style="border-radius: 15px; height: 200px; width: 300px;" src="https://revistatraveling.com/wp-content/uploads/2020/11/gran-via-alcala.jpg">
                       </div>
                    <div style="width: 400px;">
                        <h4 class="fw-light">{{hotel.getNombre()}}</h4>
                        <hr style="width: 50px;">
                           <div>
                               <p class="fw-light text-secondary">Este acogedor y luminoso apartamento (45m2) se encuentra en el centro de La Coruña. Con capacidad hasta para 2 huéspedes, aquí encontraréis todo lo necesario para tener una estancia inmejorable.</p>
                                       <div class="d-flex justify-content-end gap-2" style="float:right" >
                                         <span>{{hotel.getUbicacion().getProvincia()}}</span>
                                         <span>{{hotel.getPrecio()}}€/noche</span>
                                         </div>
                            </div>
                     </div>
                     </a>
                  </div>
          <!--
<h5 class="card-title">Special title treatment</h5>
          <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
          <a href="#" class="btn btn-primary">Go somewhere</a>
          -->
          
       

      {% endfor %}
      </div>
      </div>
    </div>
    </div>
    </div>
    <div id="map"></div>
  </div>
  </main>


  <script>
  
  var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function () {
        if (this.readyState === 4 && this.status === 200) {
 try {
                let filas = JSON.parse(this.responseText);
                array.push(filas);
                console.log(filas)
               
            } catch (ex) {
               
               console.log( "no hay nada")
               
            }
        }
    };
    xhttp.open("GET",'/responseExplore' , true);
    xhttp.send();
  /*variables*/
  let hotel=document.querySelector('#Hotel');
  let hostal=document.querySelector('#Hostal');
  let albergue=document.querySelector('#albergue');
  let casaRural=document.querySelector('#casaRural');
  let propietario=document.querySelector('#propietario');

  
  
  var array=new Array();
  var cambio=new Array();


var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function () {
        if (this.readyState === 4 && this.status === 200) {
 try {
                let filas = JSON.parse(this.responseText);
                array.push(filas);
                console.log(filas)
               
            } catch (ex) {
               
               console.log( "no hay nada")
               
            }
        }
    };
    xhttp.open("GET",'/responseExplore' , true);
    xhttp.send();



/*
hotel.addEventListener('click',function(){
  
filtrar(array,hotel.id);
filterMarkers(hotel.id);
sessionStorage.setItem('actividad',hotel.id);

});
hostal.addEventListener('click',function(){

  filtrar(array,hostal.id);
  filterMarkers(hostal.id);
  sessionStorage.setItem('actividad',hostal.id);
})
albergue.addEventListener('click',function(){

  filtrar(array,albergue.id);
})
casaRural.addEventListener('click',function(){

filtrar(array,casaRural.id);

})
propietario.addEventListener('click',function(){

filtrar(array,propietario.id);

})


document.addEventListener("DOMContentLoaded",function(){


if(window.sessionStorage){
let actividad=sessionStorage.getItem("actividad");
  console.log(actividad)
  filtrar(array,actividad);
  filterMarkers(actividad);

}
  
});

function filtrar(array,actividad){

console.log(array);
cambio=array.filter((element) => {
 return( element.Actividad.nombre == actividad )});
if(cambio!=undefined && cambio.length >0){
mostrarAlojamientos(cambio);
}else{
mostrarMensaje();
}

}


function mostrarMensaje(){

  let div=document.getElementById('alojamientos');
  let hijo=document.getElementById('alo-b');
  div.removeChild(hijo);


  let divhijo=document.createElement('div');
  divhijo.id="alo-b";

let parrafo=document.createElement('p');
parrafo.textContent="No hay alojamientos disponibles"
divhijo.appendChild(parrafo);
div.appendChild(divhijo);
}


function mostrarAlojamientos(array){

  let div=document.getElementById('alojamientos');
  let hijo=document.getElementById('alo-b');
  div.removeChild(hijo);


  let divhijo=document.createElement('div');
  divhijo.id="alo-b";
  
  
  for(let i=0;i<array.length;i++){

let principal=document.createElement('div');
principal.classList="col";

let item=document.createElement('div');
item.classList="packege__item";
let inner=document.createElement('div');
inner.classList="packege__inner";


let thumb=document.createElement('div');
thumb.classList="packege__thumb";
let enlace=document.createElement('a');
enlace.href="/alojamiento/" + array[i]['Nombre'];
let imagen=document.createElement('img');
imagen.setAttribute('src','/img/alojamientos/'+ array[i]['images'][0]['imageName']);
enlace.appendChild(imagen)
thumb.appendChild(enlace);

let content=document.createElement('div');
content.classList="packege__content";
let aContent=document.createElement('a');
aContent.href="/alojamiento/" + array[i]['Nombre'];
let h5=document.createElement('h5');
h5.textContent=array[0]['Nombre'];
let rivew=document.createElement('div');
rivew.classList="packege__rivew";
let left=document.createElement('div')
left.classList="left";
let span1=document.createElement('span');
span1.textContent='lugar';
let span2=document.createElement('span');
span2.textContent='jiio';
let right=document.createElement('div');
right.classList="right";
let span3=document.createElement('span');
span3.textContent="fdfdfd";
left.appendChild(span1);
left.appendChild(span2)
right.appendChild(span3);
rivew.appendChild(left);
rivew.appendChild(right);
aContent.appendChild(h5);
content.appendChild(aContent)
content.appendChild(rivew)




inner.appendChild(thumb);
inner.appendChild(content)
item.appendChild(inner);
principal.appendChild(item);
 

    divhijo.appendChild(principal)
  }

div.appendChild(divhijo);
  }
  





var map,i;
var infowindow=[];
var markers=[];
var gmarkers=[];

function initMap() {
  const valencia = {
    lat: 39.4683179,
    lng: -0.3790023
  };
  map = new google.maps.Map(document.getElementById("map"), {
    zoom: 13,
    center: valencia,
   
  });
  
  let image = {
    url: 'img/signo.png', //ruta de la imagen
    size: new google.maps.Size(60, 60), //tamaño de la imagen
    origin: new google.maps.Point(0,0), //origen de la iamgen
  //el ancla de la imagen, el punto donde esta marcando, en nuestro caso el centro inferior.
  anchor: new google.maps.Point(0, 0) 
   };

   for (i = 0; i < array.length; i++) {

      markers[i] = new google.maps.Marker({
      position: new google.maps.LatLng(array[i]['ubicacion'].latitud, array[i]['ubicacion'].longitud),
      map:map,
      actividad:array[i]['Actividad'],
      icon: image
    });

gmarkers.push(markers[i])
    infowindow[i] = new google.maps.InfoWindow({
      content:'<a href="#hola"><img style="margin:0px" src="img/tropical.png" width="250px" /><div style="w-100"><div class="p-4" style="width:250px"><h5 class="fw-light">Alojamiento entero: piso. Anfitrión: Paula</h5><span class=>250 €</span></span></div></a>' });
  google.maps.event.addListener(markers[i], 'click', function(valor) { 
    return function(){ 
    infowindow[valor].open(map,markers[valor]); 
  }
  }(i));
  
}


  };

console.log(gmarkers);

filterMarkers=function(actividad){

  for(i=0;i<gmarkers.length;i++){
    marker=gmarkers[i];
if(marker.actividad==actividad || actividad.length ===0){
marker.setVisible(true);

}else{

  marker.setVisible(false);
}

  }
}


*/

/*
function getGET()
    {
        // capturamos la url
        var loc = document.location.href;
        // si existe el interrogante
        if(loc.indexOf('?')>0)
        {
            // cogemos la parte de la url que hay despues del interrogante
            var getString = loc.split('?')[1];
            // obtenemos un array con cada clave=valor
            var GET = getString.split('&');
            var get = {};
            // recorremos todo el array de valores
            for(var i = 0, l = GET.length; i < l; i++){
                var tmp = GET[i].split('=');
                get[tmp[0]] = unescape(decodeURI(tmp[1]));
            }
            return get;
        }
    }
*/
 
    /*
        // Cogemos los valores pasados por get
        var valores=getGET();
        if(valores)
        {
            //recogemos los valores que nos envia la URL en variables para trabajar 
                //con ellas
            var actividad= valores['actividad'];
            console.log(min);
            var min=valores['minPrecio'];
            var max=valores['maxPrecio'];

            minPrecio.value=min;
            maxPrecio.value=max;
           

            filtrar(array,actividad);
             
        }else{
            // no se ha recibido ningun parametro por GET
            document.write("No se ha recibido ningún parámetro");
        }
  
*/


  </script>
{% endblock %}

  